1:"$Sreact.fragment"
2:I[7555,[],""]
3:I[1295,[],""]
6:I[9665,[],"OutletBoundary"]
8:I[4911,[],"AsyncMetadataOutlet"]
a:I[9665,[],"ViewportBoundary"]
c:I[9665,[],"MetadataBoundary"]
d:"$Sreact.suspense"
f:I[8393,[],""]
:HL["/_next/static/media/e4af272ccee01ff0-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/931b179cff3131dc.css","style"]
:HL["/_next/static/css/f56e075401be6041.css","style"]
:HL["/_next/static/css/bf413bc97a2d8c3a.css","style"]
:HL["/_next/static/css/b9c247a1f9d5af8a.css","style"]
:HL["/_next/static/css/f055e431c58b907b.css","style"]
0:{"P":null,"b":"tiUpHt7fG-8CjpfaGfSTE","p":"","c":["","blogs","connecting-a-grandstream-ht80x-ht801-or-ht802-to-twilio-sip",""],"i":false,"f":[[["",{"children":["blogs",{"children":[["slug","connecting-a-grandstream-ht80x-ht801-or-ht802-to-twilio-sip","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/931b179cff3131dc.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/f56e075401be6041.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","type":"image/x-icon","href":"/favicon.ico"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/favicon-32x32.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/apple-touch-icon-180x180.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"152x152","href":"/apple-touch-icon-152x152.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"144x144","href":"/apple-touch-icon-144x144.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"120x120","href":"/apple-touch-icon-120x120.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"114x114","href":"/apple-touch-icon-114x114.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/apple-touch-icon-76x76.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"72x72","href":"/apple-touch-icon-72x72.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"57x57","href":"/apple-touch-icon-57x57.png"}],["$","link",null,{"rel":"apple-touch-icon","href":"/apple-touch-icon.png"}],["$","link",null,{"rel":"stylesheet","href":"/style.css"}],["$","link",null,{"rel":"stylesheet","href":"/font-awesome.css"}]]}],["$","body",null,{"className":"__className_e8ce0c","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$L4",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/bf413bc97a2d8c3a.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/b9c247a1f9d5af8a.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}],{"children":["blogs",["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","connecting-a-grandstream-ht80x-ht801-or-ht802-to-twilio-sip","d"],["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L5",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/bf413bc97a2d8c3a.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/b9c247a1f9d5af8a.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/_next/static/css/f055e431c58b907b.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L6",null,{"children":["$L7",["$","$L8",null,{"promise":"$@9"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$Lc",null,{"children":["$","div",null,{"hidden":true,"children":["$","$d",null,{"fallback":null,"children":"$Le"}]}]}]]}],false]],"m":"$undefined","G":["$f",[]],"s":false,"S":true}
b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
7:null
9:{"metadata":[["$","title","0",{"children":"Michael Lunzer"}],["$","meta","1",{"name":"description","content":"Personal Site"}],["$","meta","2",{"name":"author","content":"@michaellunzer"}],["$","meta","3",{"name":"robots","content":"index, follow"}],["$","meta","4",{"property":"og:title","content":"Michael Lunzer"}],["$","meta","5",{"property":"og:description","content":"Personal Site"}],["$","meta","6",{"property":"og:url","content":"https://www.michaellunzer.com/"}],["$","meta","7",{"property":"og:site_name","content":"Michael Lunzer"}],["$","meta","8",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","9",{"name":"twitter:title","content":"Michael Lunzer"}],["$","meta","10",{"name":"twitter:description","content":"Personal Site"}]],"error":null,"digest":"$undefined"}
e:"$9:metadata"
10:I[658,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","744","static/chunks/app/blogs/%5Bslug%5D/page-dc1945ed8fd780cb.js"],"default"]
11:I[6874,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","156","static/chunks/app/blogs/page-72d57091bb988b6e.js"],""]
4:["$","$L10",null,{"siteInfo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"1vaZauN3G1LbRsJutH3AU9","type":"Entry","createdAt":"2020-05-28T21:29:56.813Z","updatedAt":"2022-04-19T07:19:17.934Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":45,"revision":18,"contentType":{"sys":{"type":"Link","linkType":"ContentType","id":"siteInformation"}},"locale":"en-US"},"fields":{"siteName":"Michael Lunzer","siteUrl":"https://michaellunzer.com","logo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"7yHuAa09NVOcZ25POk7cbM","type":"Asset","createdAt":"2020-05-28T21:29:46.445Z","updatedAt":"2020-07-03T23:34:40.696Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":35,"revision":10,"locale":"en-US"},"fields":{"title":"ML-logo-white","file":{"url":"//images.ctfassets.net/o4gibwve10tr/7yHuAa09NVOcZ25POk7cbM/9b2cb1a82fcec0461a26b030df8ed159/ML-logo-white.png","details":{"size":31304,"image":{"width":319,"height":302}},"fileName":"ML-logo-white.png","contentType":"image/png"}}},"twiteerHandle":"@michaellunzer","siteDescription":"Personal Site","menus":["Blogs","Photos","About","Contact","Work","Map","Resume","Projects","Bucket List","Spotify"]}},"children":[null,["$","div",null,{"className":"site-container","children":["$","div",null,{"className":"container","children":["$","div",null,{"className":"row","children":["$","div",null,{"className":"col-sm-12 text-center","children":[["$","h1",null,{"children":"404 - Page Not Found"}],["$","p",null,{"children":"The page you're looking for doesn't exist."}],["$","$L11",null,{"href":"/","className":"btn btn-primary","children":"Go back home"}]]}]}]}]}]]}]
12:I[3063,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","744","static/chunks/app/blogs/%5Bslug%5D/page-dc1945ed8fd780cb.js"],"Image"]
13:I[2370,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","744","static/chunks/app/blogs/%5Bslug%5D/page-dc1945ed8fd780cb.js"],"default"]
14:T1cef,# The Inspiration

I'm diving into all of Twilio's products and trying to learn as much as I can about them. The best way I learn is by actually doing it and trying to build it myself. My focus on this project was learning about [SIP Trunking](https://en.wikipedia.org/wiki/SIP_trunking). It seemed pretty straightforward, but as always the devil is in the details and there are always nuances to learn about everything. 

# Future Goal
I wanted to get an Analog Telephone Adapter, so I can hook up up an old landline telephone with an obnoxious bell and have it wake me up like an alarm clock ‚è∞. 

# Picking The Hardware
There's a bunch of Analog Telephone Adatpers (ATA) out there. I was also looking at the Cisco ATA 191 but ultimately settled on the Grandstream HT801 because it was less than $20 from someone on eBay and I found these [instructions from Nick Busey](https://nickbusey.com/article/2020-05-04-twilio-grandstream/) on how to set up the device specifically with Twilio SIP. I thought that because it was a recent post, that I wouldn't have much difficulty trying to configure it. Here's the [Amazon link](https://amzn.to/3eh0pvG).

# Getting Started

I had orginally followed Nick's instructions but there were some drawbacks. I had trouble with inbound calls and also triggering calls with the REST API.

![Twilio SIP ht801](//images.ctfassets.net/o4gibwve10tr/5vMqmyuNhvIWo9EVLcHc6T/89c752338f4640dbdba1307449d94a67/ht801.jpeg)

# Steps
1. [Open ports in your router's firewall](https://www.twilio.com/docs/sip-trunking/ip-addresses)
2. Configure Outbound Calls
3. Configure Inbound Calls
4. Configure the Grandstream device

Unfortunately, in Nick's use-case, he only needed outbound calling, which made the phone only half as useful for me haha. I recognized his name as the creator/maintainer of the [HomeLabOS project](https://homelabos.com/). So I knew I could find him on the [HomeLabOS Zulip Chat](https://homelabos.zulipchat.com/login/) and asked him a few questions on if he was able to get outbound AND inbound calling working. He graciously answered a few of my questions. Unfortunately, he doesn't use the device anymore and didn't look into getting inbound calls more. 

So, at this point I was able to configure the device and have outbound calling going, but I needed more. So, I logged a Service Ticket with Twilio. Again, this was a good excuse to learn more about Twilio by using the products like Customer Support. 

A customer service rep was able to help me troubleshoot the issue and taught me a few things along the way, like this... ~~

## __Pro Tip__: 
You can download the PCAP file and explore it with WireShark to explore the headers and see what's going on during the connection process. 

![Twilio SIP Console PCAP Download](//images.ctfassets.net/o4gibwve10tr/4CU6J6FmWG9p1htwpLGfnd/555cdcb916537e24e7d5a20b42f1420c/Screen_Shot_2021-03-06_at_9.36.52_PM.png)

During the connection process for incoming calls, he explained that the Contact section in the Header was trying to return the local IP address of the ATA box instead of my public IP address of my home internet connection -- so something was literally getting lost in translation, well the *Network Address Translation* (NAT). 

![Twilio SIP Support Screen Shot](//images.ctfassets.net/o4gibwve10tr/1PRNejlAqqLlX72Rw3h1Pm/90a77a6889ef174c0dd1148ba8548923/Twilio_SIP_Support_Screen_Shot.png)

At first, I ended up hard-coding my public IP address in this section of the Grandstream configuration like this:

`Use NAT IP: 123.456.78.90`

<br />

However, there were some issues if you put in your Public IP address -- better hope it doesn't change! This "hack" overrides the internal IP address that was being returned in the Header and allows incoming calls to come in. I tried to use a Dynamic DNS address but the field only allowed enough digits for an IP address. 

With the first configuration, I was having trouble receiving calls via a REST API command. Investigating into the PCAP file helped me troubleshoot. After taking a step back, I ended up figuring the right configuration!

# Create a SIP Trunk

Name it something and add an `Origination URL`: `sip:username@your_domain.sip.us1.twilio.com`

# Configure a SIP Domain in Twilio Programmable Voice

make the `SIP URI` something easy for you to remember. This will be the url of the `Primary SIP Server` on your Grandstream box. With that, you'll have to add a value to the `IP Access Control List` and a `Credential List`. The username/password you put in your `Credential List` will be the `SIP User ID` and the `Authenticate ID` on your Grandstream box.

![twilio wake up call - SIP domain configuration](//images.ctfassets.net/o4gibwve10tr/3PhjpqA93wUNsZuwtAYRq7/2e955afcc78a2f6b8936d2936f79d5ef/twilio_wake_up_call_-_SIP_domain_configuration.png)

# Create a Credential

![Twilio Wake Up Call - Create a Credential](//images.ctfassets.net/o4gibwve10tr/6UFXmIFSYs9UWA5NHyxBXH/3c430249d1de1494a0cecf8950381116/Twilio_Wake_Up_Call_-_Create_a_Credential.png)

# Configure Outgoing Calls with a TwiML Bin
While you're here, scroll down and add a TwiML Bin for when `A Call Comes In` so you can make outgoing calls.

```xml
<?xml version="1.0" encoding="UTF-8"?>
<Response>
  <Dial callerId="+14151234567">{{#e164}}{{To}}{{/e164}}</Dial>
</Response>
```

![Twilio Wake Up Call - Outgoing Call Configuration](//images.ctfassets.net/o4gibwve10tr/2lskbw5hNGL8krdI7eycXh/cdca8645356f3265124beac269f06ed2/Twilio_Wake_Up_Call_-_Outgoing_Call_Configuration.png)

# SIP Registration

![Twilio Wake Up Call - SIP Registration](//images.ctfassets.net/o4gibwve10tr/4rMReu6moj5v0qwb3zgy5B/e6216b1238527be6ea04706f2ae011c7/Twilio_Wake_Up_Call_-_SIP_Registration.png)

# Screenshot of Grandstream Configuration

When I was looking for help on the configuration, I kept seeing sections but wanted the FULL image. So, here's mine, in its entirety. 

Update the following fields:
- Primary SIP Server: your_domain.sip.us1.twilio.com
- SIP User ID
- Authenticate ID
- Authenticate Password
- SIP REGISTER Contact Uses: WAN Address
- Check SIP User ID for incoming INVITE
- Dial Plan Prefix: +

![Grandstream Device Configuration Updated](//images.ctfassets.net/o4gibwve10tr/53eDJwKJymDedxUyHBJq8R/5103801c7ec19c344e1718770a41daa6/Grandstream_Device_Configuration_Updated.png)

# Confirm SIP Registration

You'll see your username and "Registered" on the Port Status line.

![Twilio Wake Up Call - Confirm Registration](//images.ctfassets.net/o4gibwve10tr/6GJlfNCyE6VFwjFgMvF0vN/397a23d05568bc620bbd799fb8b59ea7/Screen_Shot_2021-03-30_at_8.48.33_PM.png)

# Configure Incoming Calls With a TwiML Bin

As outlined [here](https://www.twilio.com/docs/voice/api/sip-registration#receiving-calls-on-your-registered-sip-endpoint)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<Response>
  <Dial answerOnBridge="true">
    <Sip>username@your_domain.sip.twilio.com</Sip>
  </Dial>
</Response>
```

Go to your phone number in the Numbers Tab and click on it.
`When a Comes In`: run the TwiML Bin you just created above.

# Next Steps
It'd be fun to setup a PBX server and have IP Phones with different extensions for each room in my house, but it's probably extreme overkill for what I need. Here's how I incorporate the ATA landline into a new type of [Wake Up Call Alarm project](https://michaellunzer.com/projects/home-assistant-wake-up-alarm-with-a-phone-call).5:["$","$L10",null,{"siteInfo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"1vaZauN3G1LbRsJutH3AU9","type":"Entry","createdAt":"2020-05-28T21:29:56.813Z","updatedAt":"2022-04-19T07:19:17.934Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":45,"revision":18,"contentType":{"sys":{"type":"Link","linkType":"ContentType","id":"siteInformation"}},"locale":"en-US"},"fields":{"siteName":"Michael Lunzer","siteUrl":"https://michaellunzer.com","logo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"7yHuAa09NVOcZ25POk7cbM","type":"Asset","createdAt":"2020-05-28T21:29:46.445Z","updatedAt":"2020-07-03T23:34:40.696Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":35,"revision":10,"locale":"en-US"},"fields":{"title":"ML-logo-white","file":{"url":"//images.ctfassets.net/o4gibwve10tr/7yHuAa09NVOcZ25POk7cbM/9b2cb1a82fcec0461a26b030df8ed159/ML-logo-white.png","details":{"size":31304,"image":{"width":319,"height":302}},"fileName":"ML-logo-white.png","contentType":"image/png"}}},"twiteerHandle":"@michaellunzer","siteDescription":"Personal Site","menus":["Blogs","Photos","About","Contact","Work","Map","Resume","Projects","Bucket List","Spotify"]}},"children":[null,["$","div",null,{"className":"site-container blog-post","children":["$","div",null,{"className":"container","children":[["$","div",null,{"className":"feature-img","children":["$","$L12",null,{"src":"https://images.ctfassets.net/o4gibwve10tr/5e54w5WprkodnaJyjk15dc/f4ca8c28e9c51332108e3b780c6f23d3/template.jpg","alt":"Connecting a Grandstream HT80X (HT801 or HT802) to Twilio SIP","width":1500,"height":800,"className":"img-fluid","style":{"objectFit":"cover","objectPosition":"50% 50%"}}]}],["$","div",null,{"className":"details","children":[["$","h1",null,{"className":"title","children":"Connecting a Grandstream HT80X (HT801 or HT802) to Twilio SIP"}],["$","span",null,{"className":"date","children":[["$","i",null,{"className":"fas fa-calendar-alt"}]," ","August 2, 2025"]}],["$","$L13",null,{"content":"$14"}]]}],"$L15","$L16"]}]}]]}]
17:I[5183,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","744","static/chunks/app/blogs/%5Bslug%5D/page-dc1945ed8fd780cb.js"],"default"]
15:["$","$L17",null,{"socialConfig":{"siteurl":"https://michaellunzer.com","twitterHandle":"@michaellunzer","config":{"url":"https://michaellunzer.com/blogs/connecting-a-grandstream-ht80x-ht801-or-ht802-to-twilio-sip","title":"Connecting a Grandstream HT80X (HT801 or HT802) to Twilio SIP"}}}]
16:["$","div",null,{"className":"comments-section","children":[["$","h3",null,{"children":"Comments"}],["$","p",null,{"children":"Comments are currently disabled. Feel free to reach out on social media!"}]]}]
