{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/sending-sms-messages-with-twilio-on-esphome","result":{"data":{"contentfulBlogs":{"id":"d385ada3-e068-500d-bdd7-1ddc59a9dbcd","title":"Sending SMS Messages with Twilio on ESPHome","slug":"sending-sms-messages-with-twilio-on-esphome","featureImage":{"gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=320&h=180&q=50&fm=webp 320w,\nhttps://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=640&h=360&q=50&fm=webp 640w,\nhttps://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=1280&h=720&q=50&fm=webp 1280w","sizes":"(min-width: 1280px) 1280px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=1280&h=720&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=320&h=180&fl=progressive&q=50&fm=jpg 320w,\nhttps://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=640&h=360&fl=progressive&q=50&fm=jpg 640w,\nhttps://images.ctfassets.net/o4gibwve10tr/2w0lBdVCP8Hx7k5uwl3vIi/50f023bab6d77bc44a44b4c5dfdc5352/ESPHome_Twilio_Logos_2.jpg?w=1280&h=720&fl=progressive&q=50&fm=jpg 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"}},"layout":"constrained","backgroundColor":"#1868d8","width":1280,"height":720}},"description":{"childMarkdownRemark":{"html":"<p>Sending SMS messages from a microcontroller isn't new. There's a bunch of examples on the Twilio blog on how to accomplish this -- like this <a href=\"https://www.twilio.com/blog/sms-doorbell-micropython-twilio\">one</a> or <a href=\"https://www.twilio.com/blog/2017/06/build-a-smart-doorbell-with-twilio-and-android-things.html\">this one</a> and many more around the internet.</p>\n<p>Where this is different is by using ESPHome to program the esp8266 instead of micropython or the arduino IDE. As you can probably tell from the Projects section of this website, I've really enjoyed using ESPHome to quickly program devices and set up sensors using YAML.</p>\n<p>Ultimately, I'm hoping to add this to my existing doorbell, giving it SMS capabilities -- more to come soon on that. Here's a quick breadboard prototype with a few buttons that trigger an SMS when pressed.</p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/5SUlANTSunajcJ6oDPFALu/120d33f01bedfd2def7af1e61be3571e/IMG_5305.jpeg\" alt=\"twilio doorbell prototype\"></p>\n<p>I'm posting my code below and have commented exactly what you need to do to accomplish this yourself!</p>\n<p>One section to highlight is the <code class=\"language-text\">authorization</code> section in the <code class=\"language-text\">Header</code>. I figured out that for Basic Authorization, you need to encode your AccountSID and API key in base64.</p>\n<p>Take your &#x3C;Account_SID>:&#x3C;API_KEY> (make sure to put a colon in between the Account SID and API Key) take it and paste it on <a href=\"https://www.base64encode.org/\">this page</a>  and put the resulting string into this form (replacing the xxxxxxxxx with the resulting output from the base64encode website):\n<code class=\"language-text\">Authorization: \"Basic xxxxxxxxx\"</code></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\">\n<span class=\"token key atrule\">esphome</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> twilio_doorbell\n  <span class=\"token key atrule\">platform</span><span class=\"token punctuation\">:</span> ESP8266\n  <span class=\"token key atrule\">board</span><span class=\"token punctuation\">:</span> huzzah\n\n<span class=\"token key atrule\">wifi</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ssid</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"network_name\"</span>\n  <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"network_password\"</span>\n\n    <span class=\"token comment\"># Enable fallback hotspot (captive portal) in case wifi connection fails</span>\n  <span class=\"token key atrule\">ap</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">ssid</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Twilio Doorbell Fallback Hotspot\"</span>\n    <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"random_password\"</span>\n\n<span class=\"token key atrule\">captive_portal</span><span class=\"token punctuation\">:</span>\n\n<span class=\"token comment\"># Enable logging</span>\n<span class=\"token key atrule\">logger</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># level: VERBOSE  ## not needed anymore</span>\n\n<span class=\"token comment\"># Enable Home Assistant API</span>\n<span class=\"token key atrule\">api</span><span class=\"token punctuation\">:</span>\n\n<span class=\"token key atrule\">ota</span><span class=\"token punctuation\">:</span>\n\n<span class=\"token key atrule\">http_request</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">useragent</span><span class=\"token punctuation\">:</span> esphome/device\n  <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> 10s\n\n<span class=\"token comment\">#### Button 1</span>\n<span class=\"token key atrule\">binary_sensor</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">platform</span><span class=\"token punctuation\">:</span> gpio\n  <span class=\"token comment\">### debounce on the button press</span>\n    <span class=\"token key atrule\">filters</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">delayed_on</span><span class=\"token punctuation\">:</span> 10ms\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">delayed_off</span><span class=\"token punctuation\">:</span> 10ms\n    <span class=\"token key atrule\">pin</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">number</span><span class=\"token punctuation\">:</span> GPIO14\n      <span class=\"token key atrule\">mode</span><span class=\"token punctuation\">:</span> INPUT_PULLUP\n      <span class=\"token key atrule\">inverted</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">TRUE</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"twilio_doorbell_michael\"</span>\n    <span class=\"token key atrule\">device_class</span><span class=\"token punctuation\">:</span> moving\n    <span class=\"token key atrule\">on_click</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http_request.post</span><span class=\"token punctuation\">:</span> \n          <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//api.twilio.com/2010<span class=\"token punctuation\">-</span>04<span class=\"token punctuation\">-</span>01/Accounts/AC_twilio_account_SID/Messages\n          <span class=\"token key atrule\">headers</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">authorization</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Basic QUM3MT_random_numbers_and_letters_NTVkNWZlZjVjZjE1Yg==\"</span> \n            <span class=\"token comment\">### I read on some random blog that Basic Auth needs to be in base64 and it worked! </span>\n            <span class=\"token comment\">##### Take your &lt;Account_SID>:&lt;API_KEY> (make sure to put a colon in between the Account SID and API Key) take it and paste it on this page https://www.base64encode.org/  </span>\n            <span class=\"token comment\">####### Take the output and paste it in like this: </span>\n            <span class=\"token comment\">############# Authorization: \"Basic xxxxxxxxx\"</span>\n\n            <span class=\"token key atrule\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/x-www-form-urlencoded\"</span> <span class=\"token comment\"># this is the Content-Type they used in this example:    https://www.twilio.com/blog/send-test-http-requests-twilio-sms-postman</span>\n          <span class=\"token key atrule\">body</span><span class=\"token punctuation\">:</span>\n            <span class=\"token string\">\"To=+16505551234&amp;From=+14155551234&amp;Body=Ding Dong! Someone's at your front door!\"</span>\n            <span class=\"token comment\">##### The body needs to be a string in key=value format separated by &amp; signs: \"key1=value1&amp;key2=value2&amp;key3=value3\"</span>\n          <span class=\"token key atrule\">verify_ssl</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n          <span class=\"token comment\">#### this is a verification of SSL on the device side (not the Twilio side)</span>\n</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Let me know if you incorporate this into one of your projects! I can see this being useful for water detection sensors and provide urgent SMS notifications if it detects a leak!</p>"}},"createdAt":"2021-02-01T06:22:02.959Z"},"contentfulSiteInformation":{"siteUrl":"https://michaellunzer.com","twiteerHandle":"@michaellunzer"}},"pageContext":{"slug":"sending-sms-messages-with-twilio-on-esphome"}},"staticQueryHashes":["1194089924","1242132861","1746898652","1794736483","425184262","603260039","868401008"]}