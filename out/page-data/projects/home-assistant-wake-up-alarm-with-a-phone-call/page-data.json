{"componentChunkName":"component---src-templates-project-post-js","path":"/projects/home-assistant-wake-up-alarm-with-a-phone-call","result":{"data":{"contentfulProjects":{"id":"f8d8a725-493e-51b8-8257-427195206bc7","title":"Home-Assistant: Wake Up Alarm with a Phone Call","slug":"home-assistant-wake-up-alarm-with-a-phone-call","featureImage":{"gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=320&h=180&q=50&fm=webp 320w,\nhttps://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=640&h=360&q=50&fm=webp 640w,\nhttps://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=1280&h=720&q=50&fm=webp 1280w","sizes":"(min-width: 1280px) 1280px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=1280&h=720&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=320&h=180&fl=progressive&q=50&fm=jpg 320w,\nhttps://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=640&h=360&fl=progressive&q=50&fm=jpg 640w,\nhttps://images.ctfassets.net/o4gibwve10tr/7i5kV3exwDyVERd9oa2o9t/9d0a868daee3c2ca013942dafb490834/Twilio_Wake_Up_Call.jpg?w=1280&h=720&fl=progressive&q=50&fm=jpg 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"}},"layout":"constrained","backgroundColor":"#1868d8","width":1280,"height":720}},"description":{"childMarkdownRemark":{"html":"<h1>Video Demo:</h1>\n<iframe width=\"100%\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/FxJ2FqBKSSE?rel=0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<h1>Update 2/25/2022</h1>\n<p>I put together the video above and presented the project during the Twilio Services Kickoff Demo Jam competition -- I got 3rd place! Woohooü•â</p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/24A6jFFrZV4iIwCblSEOvA/358fbf5e0421fe5b4fcedc97a649334b/Twilio_3rd_Place__Front_.png\" alt=\"Twilio 3rd Place (Front)\"></p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/2OmKMuuU65yFlvtSEJnxB7/e5541c82fd19a97c5d4fc94275b81ec6/Twilio_3rd_Place__Back_.png\" alt=\"Twilio 3rd Place (Back)\"></p>\n<h1>Motivation:</h1>\n<p>Sometimes it's hard for me to get out of bed in the morning. I've tried a ton of things:</p>\n<ul>\n<li>Waking up to music</li>\n<li>Automations that turn the lights on gently to simulate a sunrise</li>\n<li>Setting multiple alarms across the room</li>\n<li>An <a href=\"https://www.reddit.com/r/GetMotivatedBuddies/\">Accountability Buddy</a> / Internet Stranger to check in with each other in the morning to make sure we're up</li>\n<li><a href=\"https://freeappsforme.com/alarm-clock-apps-with-math-challenges/\">Apps that ask me to do math problems</a></li>\n</ul>\n<p>But I always enjoyed getting the wake up call on business trips. Going off of that idea, I set up a landline in my house and acquired a really <del>annoying</del> loud phone with an actual bell to call me in the morning and wake me up with a quick math problem to get my brain activity going.</p>\n<p>If this doesn‚Äôt work, I‚Äôll have to look into making an ejector bed lol</p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/6RXjg2TqWnkgjZG04mZeQ8/bfc8980ccf076899a5006012805775bd/_u_http_3A_2F_2Fi.giphy.com_2F3og0ISQyRWLAkOvg6A.gif_f_1_nofb_1\" alt=\"Twilio Wake Up Call ejector bed gif\"></p>\n<h1>Try it out yourself:</h1>\n<p><strong>Call this number:</strong> (415) 358-6870</p>\n<p>It will ask you a simple math question and tell you if you‚Äôre right or wrong. If you get scared talking to people on the phone, don‚Äôt be. It‚Äôs just a robot on the other side.</p>\n<h1>Getting Started on the Twilio Console</h1>\n<p>First, I pulled up the Twilio Console and purchased a phone number ($1/mo)</p>\n<p>Next, I navigated into Twilio Studio and built a Studio Flow that calls you when you hit the Studio Flow URL with a request from Home-Assistant.</p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/31Li8fctiN6m1gZfoXyaFl/6a524701c1a2647899ebb20e2c03ee63/Screen_Shot_2021-03-09_at_9.25.00_PM.png\" alt=\"Twilio Wake Up Call Studio Flow\"></p>\n<p>I've glossed over how I created the Flow, but it went through a couple iterations. Basically, I built a function that picks a random, whole, positive number in a simple equation that always returned a whole and positive number as an answer. It's running in a Twilio Function that is run during the call, so there is sometimes a longer pause because it has to run the function a few times if one of the conditions isn't met. I'm sure there are better ways to accomplish it, but this works for me. The entire interaction is less than 30 seconds.</p>\n<p>After that I needed a way in Home-Assistant to trigger the REST command and ultimately in an automation.</p>\n<h1>Home-Assistant REST Command:</h1>\n<p>This REST command triggers a phone call to the number specified in it.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\">\n<span class=\"token key atrule\">rest_command</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">twilio_alarm</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"https://studio.twilio.com/v2/Flows/FW79cc6cc54bddc17e431f9e3d27fe8da1/Executions\"</span>\n    <span class=\"token key atrule\">method</span><span class=\"token punctuation\">:</span> POST\n    <span class=\"token key atrule\">headers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">Content-Type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/x-www-form-urlencoded\"</span>\n    <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> ACxxxxxxxxxx9918e978bdb60ca6a90f5c\n    <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> bxxxxxxxxxxxaf5cc3d655d5fef5cf15b\n    <span class=\"token key atrule\">payload</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"To=+16501234567&amp;From=+14153586870\"</span>\n<span class=\"token comment\"># replace the To Number with yours. Leave the From Number as is -- this is the number you‚Äôll get a call from!</span>\n<span class=\"token comment\"># keep the URL the same to use my Flow!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1>Home-Assistant Automation:</h1>\n<p>I‚Äôm using Node-Red to trigger my wake up automation. It looks like there‚Äôs a lot going on, but basically I only trigger the the alarm based on certain conditions:</p>\n<ol>\n<li>A switch on the dashboard is turned on (for example, I turn it off during a holiday)</li>\n<li>I‚Äôm physically home</li>\n<li>It‚Äôs a work day at 7am</li>\n</ol>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/7MbCZsJ4Wh8h9shAFWXmnE/315e516bf3c96483d1cb3fb3f10972a3/Screen_Shot_2021-03-09_at_11.46.22_PM.png\" alt=\"Twilio Wake Up Call Node Red Automation\"></p>\n<p>You can also trigger the REST command with a normal automation within Home-Assistant.</p>\n<h1>Triggering a Test Call</h1>\n<p>During the testing phase, I wanted a button on my dashboard that I could press and trigger the phone call. Unfortunately, it‚Äôs never that easy lol -- I had to use a <a href=\"https://github.com/custom-cards/button-card\">custom button-card</a> so I could call a service (the REST command) from the button. You can‚Äôt trigger a service from a normal button card!</p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/5AhKmNQxvgtI5cfSmly3T2/11fce0bea74e1cbfe41765fdb149a99f/Screen_Shot_2021-03-09_at_11.15.03_PM.png\" alt=\"Twilio Wake Up Call Button Card\"></p>\n<h1>Bonus: Get a landline to connect a ‚Äúold‚Äù telephone</h1>\n<p>Last thing is I needed a landline. I bought a Grandstream HT801 Analog Telephone Adapter and set it up with Twilio SIP. You can read more about how I set that up in this <a href=\"https://michaellunzer.com/blogs/connecting-a-grandstream-ht80x-ht801-or-ht802-to-twilio-sip\">blog post</a>. I plugged it in, configured it, and then connected it to my home phone network.</p>\n<p>Once I did that, I was able to have an old landline telephone connected to the Telephone network with a phone number.</p>\n<p>Now every morning, I get a wake up call and it asks me to do a simple math question. Nothing peaks my anxiety like trying to solve mental math questions on the spot early in the morning!</p>\n<p><img src=\"//images.ctfassets.net/o4gibwve10tr/1xAIGpLRMafoFJio0ZPMIJ/56eea041fdb2c448df2ddade8b1fda2b/_u_https_3A_2F_2Fd2rd7etdn93tqb.cloudfront.net_2Fwp-content_2Fuploads_2F2018_2F09_2Fhide-your-pain-harold-meme-ph.jpg_f_1_nofb_1\" alt=\"Twilio Wake Up Call phone meme guy picture\"></p>\n<h1>Future Ideas</h1>\n<p><del>It'd be fun to see if I can pull a Quote of the Day from an API to provide morning motivation to users getting ready to wake up.</del></p>\n<p>This was added!</p>\n<h1>Setting it up for yourself</h1>\n<p>If you're interested in setting this up for yourself, please contact me. I'm happy to help you set this up and we might be able to set up a way where you can use my Studio Flow and Phone Number.</p>"}},"createdAt":"2021-03-10T08:22:43.232Z","publishedDate":"2021-03-09"},"contentfulSiteInformation":{"siteUrl":"https://michaellunzer.com","twiteerHandle":"@michaellunzer"}},"pageContext":{"slug":"home-assistant-wake-up-alarm-with-a-phone-call"}},"staticQueryHashes":["1194089924","1242132861","1746898652","1794736483","425184262","603260039","868401008"]}