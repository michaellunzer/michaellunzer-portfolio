1:"$Sreact.fragment"
2:I[7555,[],""]
3:I[1295,[],""]
6:I[9665,[],"OutletBoundary"]
8:I[4911,[],"AsyncMetadataOutlet"]
a:I[9665,[],"ViewportBoundary"]
c:I[9665,[],"MetadataBoundary"]
d:"$Sreact.suspense"
f:I[8393,[],""]
:HL["/_next/static/media/e4af272ccee01ff0-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/931b179cff3131dc.css","style"]
:HL["/_next/static/css/f56e075401be6041.css","style"]
:HL["/_next/static/css/96b2ede580997a88.css","style"]
:HL["/_next/static/css/b9c247a1f9d5af8a.css","style"]
:HL["/_next/static/css/f055e431c58b907b.css","style"]
0:{"P":null,"b":"bCU5C4Z5V3RSXa88yhwcO","p":"","c":["","projects","esphome-spotify-oled-display",""],"i":false,"f":[[["",{"children":["projects",{"children":[["slug","esphome-spotify-oled-display","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/931b179cff3131dc.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/f56e075401be6041.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","type":"image/x-icon","href":"/favicon.ico"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/favicon-32x32.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"180x180","href":"/apple-touch-icon-180x180.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"152x152","href":"/apple-touch-icon-152x152.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"144x144","href":"/apple-touch-icon-144x144.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"120x120","href":"/apple-touch-icon-120x120.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"114x114","href":"/apple-touch-icon-114x114.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/apple-touch-icon-76x76.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"72x72","href":"/apple-touch-icon-72x72.png"}],["$","link",null,{"rel":"apple-touch-icon","sizes":"57x57","href":"/apple-touch-icon-57x57.png"}],["$","link",null,{"rel":"apple-touch-icon","href":"/apple-touch-icon.png"}],["$","link",null,{"rel":"stylesheet","href":"/style.css"}],["$","link",null,{"rel":"stylesheet","href":"/font-awesome.css"}]]}],["$","body",null,{"className":"__className_e8ce0c","children":["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$L4",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/96b2ede580997a88.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/b9c247a1f9d5af8a.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]]}],{"children":["projects",["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","esphome-spotify-oled-display","d"],["$","$1","c",{"children":[null,["$","$L2",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L5",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/96b2ede580997a88.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/b9c247a1f9d5af8a.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/_next/static/css/f055e431c58b907b.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L6",null,{"children":["$L7",["$","$L8",null,{"promise":"$@9"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$Lc",null,{"children":["$","div",null,{"hidden":true,"children":["$","$d",null,{"fallback":null,"children":"$Le"}]}]}]]}],false]],"m":"$undefined","G":["$f",[]],"s":false,"S":true}
b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
7:null
9:{"metadata":[["$","title","0",{"children":"Michael Lunzer"}],["$","meta","1",{"name":"description","content":"Personal Site"}],["$","meta","2",{"name":"author","content":"@michaellunzer"}],["$","meta","3",{"name":"robots","content":"index, follow"}],["$","meta","4",{"property":"og:title","content":"Michael Lunzer"}],["$","meta","5",{"property":"og:description","content":"Personal Site"}],["$","meta","6",{"property":"og:url","content":"https://www.michaellunzer.com/"}],["$","meta","7",{"property":"og:site_name","content":"Michael Lunzer"}],["$","meta","8",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","9",{"name":"twitter:title","content":"Michael Lunzer"}],["$","meta","10",{"name":"twitter:description","content":"Personal Site"}]],"error":null,"digest":"$undefined"}
e:"$9:metadata"
10:I[658,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","734","static/chunks/734-ef6b31103eb86462.js","419","static/chunks/app/projects/%5Bslug%5D/page-e9b2fba7deab289a.js"],"default"]
11:I[6874,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","893","static/chunks/app/projects/page-e2e8a22ab075e965.js"],""]
4:["$","$L10",null,{"siteInfo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"1vaZauN3G1LbRsJutH3AU9","type":"Entry","createdAt":"2020-05-28T21:29:56.813Z","updatedAt":"2022-04-19T07:19:17.934Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":45,"revision":18,"contentType":{"sys":{"type":"Link","linkType":"ContentType","id":"siteInformation"}},"locale":"en-US"},"fields":{"siteName":"Michael Lunzer","siteUrl":"https://michaellunzer.com","logo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"7yHuAa09NVOcZ25POk7cbM","type":"Asset","createdAt":"2020-05-28T21:29:46.445Z","updatedAt":"2020-07-03T23:34:40.696Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":35,"revision":10,"locale":"en-US"},"fields":{"title":"ML-logo-white","file":{"url":"//images.ctfassets.net/o4gibwve10tr/7yHuAa09NVOcZ25POk7cbM/9b2cb1a82fcec0461a26b030df8ed159/ML-logo-white.png","details":{"size":31304,"image":{"width":319,"height":302}},"fileName":"ML-logo-white.png","contentType":"image/png"}}},"twiteerHandle":"@michaellunzer","siteDescription":"Personal Site","menus":["Blogs","Photos","About","Contact","Work","Map","Resume","Projects","Bucket List","Spotify"]}},"children":[null,["$","div",null,{"className":"site-container","children":["$","div",null,{"className":"container","children":["$","div",null,{"className":"row","children":["$","div",null,{"className":"col-sm-12 text-center","children":[["$","h1",null,{"children":"404 - Page Not Found"}],["$","p",null,{"children":"The page you're looking for doesn't exist."}],["$","$L11",null,{"href":"/","className":"btn btn-primary","children":"Go back home"}]]}]}]}]}]]}]
12:I[3063,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","734","static/chunks/734-ef6b31103eb86462.js","419","static/chunks/app/projects/%5Bslug%5D/page-e9b2fba7deab289a.js"],"Image"]
13:I[2370,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","734","static/chunks/734-ef6b31103eb86462.js","419","static/chunks/app/projects/%5Bslug%5D/page-e9b2fba7deab289a.js"],"default"]
14:T17f2,Background
==========

I've created an OLED Display that cycles through the time, what's playing on Spotify, and the current temperature based on other ESP8266 sensors in the room. All of this is possible with [ESPHome](https://esphome.io/) to program the ESP8266 microcontroller (in this case a [Wemos D1 Mini](https://amzn.to/30qNZJk)) connected to [Home-Assistant](https://www.home-assistant.io/).

I later added a feature to make the screen turn blank when a switch on the Home-Assistant Dashboard is flipped, so the screen wouldn't illuminate my room at night. Please check the code for the Template Switch at the bottom.

Instructions
============

-   upload the **.tff** fonts like **arial.tff** and the others into the ***esphome*** directory on your Home-Assistant instance.

    -   they can be pulled from your windows font directory or downloaded from the internet.

-   create **sensor.spotify_song** and **sensor.spotify_artist** sensors using this yaml and your already configured [spotify media player integration](https://www.home-assistant.io/components/spotify/).

Spotify Sensor YAML Code:
-------------------------

```yaml
spotify_song:
  friendly_name: "Spotify Song"
  value_template: "{{ state_attr('media_player.spotify', 'media_title') }}"
```

```yaml
spotify_artist:
  friendly_name: "Spotify Artist"
  value_template: "{{ state_attr('media_player.spotify', 'media_artist') }}"
```

### ESPHome YAML Code

```yaml
wifi:
  ssid: "wifi_network"
  password: "wifi_password"
  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "OLED Display01 Fallback Hotspot"
    password: "password"
captive_portal:
# Enable logging
logger:
# Enable Home Assistant API
api:
ota:
time:
  - platform: homeassistant
    id: time1
text_sensor:
  - platform: homeassistant
    id: spotify_song
    entity_id: sensor.spotify_song
    internal: true
 
  - platform: homeassistant
    id: spotify_artist
    entity_id: sensor.spotify_artist
    internal: true
   
sensor:
### temp sensors
  - platform: homeassistant
    id: room_temperature
    entity_id: sensor.sn1_temperature
    internal: true
  - platform: homeassistant
    id: stereo_temperature
    entity_id: sensor.stereo_amp_temperature
    internal: true
 
switch:
  - platform: template
    name: "OLED_Display01 Screen"
    id: oled_display01_dnd
    optimistic: True
    # inverted: True
    on_turn_on:
      - logger.log: "Switch Turned On!"
      # - delay: 2s
      - display.page.show: page4
      # - delay: 2s
      - component.update: my_display
font:
  - file: 'arial.ttf' #'slkscr.ttf'
    id: font1
    size: 12
 
  - file: 'BebasNeue-Regular.ttf'
    id: font2
    size: 48
 
  - file: 'arial.ttf'
    id: font3
    size: 18
   
  - file: 'arialbd.ttf'
    id: font4
    size: 14
   
  - file: 'arial.ttf'
    id: font5
    size: 20
 
i2c:
  # sda: D1
  # scl: D2
  # scan: False
  # swap for Wemos D1 Mini
  sda: D2
  scl: D1
  scan: False
 
display:
  - platform: ssd1306_i2c
    model: "SSD1306 128x64"
    reset_pin: D0
    address: 0x3C
    id: my_display
    pages:
      - id: page1
        lambda: |-
          // Print time in HH:MM format
          it.strftime(0, 60, id(font2), TextAlign::BASELINE_LEFT, "%l:%M", id(time1).now());
          // Print AM/PM
          it.strftime(127, 60, id(font5), TextAlign::BASELINE_RIGHT, "%P", id(time1).now());
      - id: page2
        lambda: |-
          // it.print(0, 10, id(font1), "This is page 2!");
          // Print "Spotify Song" in top center.
          if (id(spotify_artist).has_state()) {
            it.printf(0, 8, id(font5), TextAlign::TOP_LEFT, "%s", id(spotify_artist).state.c_str());
          }
          if (id(spotify_song).has_state()) {
            it.printf(0, 55, id(font5), TextAlign::BASELINE_LEFT, "%s", id(spotify_song).state.c_str());
          }
      - id: page3
        lambda: |-
          // it.print(0, 10, id(font1), "This is page 3!");
          // Print room temperature (from homeassistant sensor)
          if (id(room_temperature).has_state()) {
            it.printf(0, 15, id(font5), TextAlign::TOP_LEFT, "Room: %.1f°", id(room_temperature).state);
          }
          // Print stereo temperature (from homeassistant sensor)
          if (id(stereo_temperature).has_state()) {
            it.printf(0, 60, id(font5), TextAlign::BASELINE_LEFT, "Stereo: %.1f°", id(stereo_temperature).state);
          }
      - id: page4
        lambda: |-
          it.print(0, 10, id(font1), "");
 
interval:
  - interval: 3s
    then:
      if:
        condition:
          lambda: return !id(oled_display01_dnd).state;
        then:
          - display.page.show: !lambda |-
              static int pagenum = 0;
              static display::DisplayPage* pages[] = {id(page1), id(page2), id(page3)};
              auto page = pages[pagenum++];
              if (pagenum >= 3)
                pagenum = 0;
              return page;
          - component.update: my_display
```

### Template Sensor

This template sensor inverses the ESPHome Switch. I couldn't find a way to invert it natively in ESPHome, so I went this route. Please let me know if you've figured out a better way!

```yaml
### template switch to reverse the oled_display01 switch
  - platform: template
    switches:
      oled_display01_inverted:
        friendly_name: "OLED Display"
        value_template: "{{ is_state('switch.oled_display01_screen', 'off') }}"
        turn_on:
          service: switch.turn_off
          data:
            entity_id: switch.oled_display01_screen
        turn_off:
          service: switch.turn_on
          data:
            entity_id: switch.oled_display01_screen
        icon_template: "{% if is_state('switch.oled_display01_screen', 'on') %}mdi:flash-outline{% else %}mdi:flash{% endif %}"
```

### Final Product


![ESPHome OLED Display - Temperature](//images.ctfassets.net/o4gibwve10tr/1JpyQhlA3m5hPsj6JX4tj7/744137bc901738f373ca9a53d8f95ebb/IMG_3382.jpg)

![ESPHome OLED Display - Spotify](//images.ctfassets.net/o4gibwve10tr/2OpQhH13GK0tMQ9U0Qnu7i/e6073675434e247e70ac3530b0e22302/IMG_3381.jpg)
5:["$","$L10",null,{"siteInfo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"1vaZauN3G1LbRsJutH3AU9","type":"Entry","createdAt":"2020-05-28T21:29:56.813Z","updatedAt":"2022-04-19T07:19:17.934Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":45,"revision":18,"contentType":{"sys":{"type":"Link","linkType":"ContentType","id":"siteInformation"}},"locale":"en-US"},"fields":{"siteName":"Michael Lunzer","siteUrl":"https://michaellunzer.com","logo":{"metadata":{"tags":[],"concepts":[]},"sys":{"space":{"sys":{"type":"Link","linkType":"Space","id":"o4gibwve10tr"}},"id":"7yHuAa09NVOcZ25POk7cbM","type":"Asset","createdAt":"2020-05-28T21:29:46.445Z","updatedAt":"2020-07-03T23:34:40.696Z","environment":{"sys":{"id":"master","type":"Link","linkType":"Environment"}},"publishedVersion":35,"revision":10,"locale":"en-US"},"fields":{"title":"ML-logo-white","file":{"url":"//images.ctfassets.net/o4gibwve10tr/7yHuAa09NVOcZ25POk7cbM/9b2cb1a82fcec0461a26b030df8ed159/ML-logo-white.png","details":{"size":31304,"image":{"width":319,"height":302}},"fileName":"ML-logo-white.png","contentType":"image/png"}}},"twiteerHandle":"@michaellunzer","siteDescription":"Personal Site","menus":["Blogs","Photos","About","Contact","Work","Map","Resume","Projects","Bucket List","Spotify"]}},"children":[null,["$","div",null,{"className":"site-container project-post","children":["$","div",null,{"className":"container","children":[["$","div",null,{"className":"feature-img","children":["$","$L12",null,{"src":"https://images.ctfassets.net/o4gibwve10tr/2OpQhH13GK0tMQ9U0Qnu7i/e6073675434e247e70ac3530b0e22302/IMG_3381.jpg","alt":"ESPHome Spotify OLED Display","width":1500,"height":800,"className":"img-fluid","style":{"objectFit":"cover","objectPosition":"50% 50%"}}]}],["$","div",null,{"className":"details","children":[["$","h1",null,{"className":"title","children":"ESPHome Spotify OLED Display"}],["$","span",null,{"className":"date","children":[["$","i",null,{"className":"fas fa-calendar-alt"}]," ","July 8, 2019"]}],["$","$L13",null,{"content":"$14"}]]}],"$L15"]}]}]]}]
16:I[5183,["778","static/chunks/778-f9403c0e33e1c074.js","63","static/chunks/63-b8ba2254fb9ac97a.js","231","static/chunks/231-25f0858d523e67a4.js","734","static/chunks/734-ef6b31103eb86462.js","419","static/chunks/app/projects/%5Bslug%5D/page-e9b2fba7deab289a.js"],"default"]
15:["$","$L16",null,{"socialConfig":{"siteurl":"https://michaellunzer.com","twitterHandle":"@michaellunzer","config":{"url":"https://michaellunzer.com/projects/esphome-spotify-oled-display","title":"ESPHome Spotify OLED Display"}}}]
